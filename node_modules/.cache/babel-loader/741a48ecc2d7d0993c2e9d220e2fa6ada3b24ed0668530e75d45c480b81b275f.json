{"ast":null,"code":"import moment from 'moment';\nconst getSafeDate = date => date || new Date().toISOString();\n\n// Enhanced Guardian type with optional createdAt and additionalGuardians\n\nexport const transformCoachData = (coaches, guardians = [], currentUser) => {\n  if (!currentUser) return [];\n\n  // For non-admin users, only show their own data\n  if (currentUser.role === 'user' && !currentUser.isCoach) {\n    return currentUser.isCoach ? [createExtendedCoachRecord(currentUser)] : [];\n  }\n  const coachRecords = coaches.map(createExtendedCoachRecord);\n  const coachGuardianRecords = guardians.flatMap(transformGuardianToRecord);\n  return [...coachRecords, ...coachGuardianRecords];\n};\nconst createExtendedCoachRecord = coach => ({\n  ...coach,\n  _id: coach._id,\n  fullName: coach.fullName,\n  email: coach.email,\n  phone: coach.phone,\n  address: coach.address,\n  role: coach.role || 'coach',\n  isCoach: true,\n  type: 'coach',\n  status: coach.status || 'Active',\n  DateofJoin: getSafeDate(coach.createdAt),\n  imgSrc: coach.avatar || 'assets/img/profiles/coach-avatar.jpg',\n  aauNumber: coach.aauNumber || 'N/A',\n  canView: true,\n  createdAt: getSafeDate(coach.createdAt),\n  players: coach.players || []\n});\nconst transformGuardianToRecord = guardian => {\n  const baseGuardianRecord = {\n    _id: guardian._id || '',\n    fullName: guardian.fullName,\n    email: guardian.email,\n    phone: guardian.phone,\n    address: guardian.address,\n    role: 'guardian',\n    isCoach: guardian.isCoach || false,\n    type: 'guardian',\n    status: 'Active',\n    DateofJoin: getSafeDate(guardian.createdAt),\n    imgSrc: 'assets/img/profiles/avatar-27.jpg',\n    aauNumber: guardian.aauNumber || 'N/A',\n    canView: true,\n    createdAt: getSafeDate(guardian.createdAt),\n    players: guardian.players || []\n  };\n  const mainGuardian = {\n    ...baseGuardianRecord\n  };\n  const additionalGuardians = (guardian.additionalGuardians || []).map((g, index) => ({\n    ...baseGuardianRecord,\n    ...g,\n    _id: g._id || `${guardian._id}-${index}`,\n    coachId: guardian._id\n  }));\n  return [mainGuardian, ...additionalGuardians];\n};\nexport const filterCoachData = (data, filters, currentUserRole) => {\n  return data.filter(item => {\n    var _item$email$toLowerCa, _item$email, _item$phone$replace$i, _item$phone, _item$aauNumber$toLow, _item$aauNumber;\n    // Role-based filtering\n    if (currentUserRole === 'user' && !item.canView) return false;\n    if (item.type !== 'guardian' && !item.isCoach) return false;\n\n    // Text filters\n    if (filters.nameFilter && !item.fullName.toLowerCase().includes(filters.nameFilter.toLowerCase())) {\n      return false;\n    }\n    if (filters.emailFilter && !((_item$email$toLowerCa = (_item$email = item.email) === null || _item$email === void 0 ? void 0 : _item$email.toLowerCase().includes(filters.emailFilter.toLowerCase())) !== null && _item$email$toLowerCa !== void 0 ? _item$email$toLowerCa : true)) {\n      return false;\n    }\n    if (filters.phoneFilter && !((_item$phone$replace$i = (_item$phone = item.phone) === null || _item$phone === void 0 ? void 0 : _item$phone.replace(/\\D/g, '').includes(filters.phoneFilter.replace(/\\D/g, ''))) !== null && _item$phone$replace$i !== void 0 ? _item$phone$replace$i : true)) {\n      return false;\n    }\n    if (filters.statusFilter && item.status !== filters.statusFilter) {\n      return false;\n    }\n    if (filters.aauNumberFilter && !((_item$aauNumber$toLow = (_item$aauNumber = item.aauNumber) === null || _item$aauNumber === void 0 ? void 0 : _item$aauNumber.toLowerCase().includes(filters.aauNumberFilter.toLowerCase())) !== null && _item$aauNumber$toLow !== void 0 ? _item$aauNumber$toLow : true)) {\n      return false;\n    }\n\n    // Date range filter\n    if (filters.dateRange) {\n      const [start, end] = filters.dateRange;\n      const itemDate = moment(item.DateofJoin);\n      if (!itemDate.isBetween(start, end, undefined, '[]')) {\n        return false;\n      }\n    }\n    return true;\n  });\n};\nexport const sortCoachData = (data, sortOrder) => {\n  if (!sortOrder) return [...data];\n  return [...data].sort((a, b) => {\n    switch (sortOrder) {\n      case 'asc':\n        return a.fullName.localeCompare(b.fullName);\n      case 'desc':\n        return b.fullName.localeCompare(a.fullName);\n      case 'recentlyAdded':\n        return new Date(b.DateofJoin).getTime() - new Date(a.DateofJoin).getTime();\n      case 'recentlyViewed':\n        const recentlyViewed = JSON.parse(localStorage.getItem('recentlyViewed') || '[]');\n        return recentlyViewed.indexOf(b._id) - recentlyViewed.indexOf(a._id);\n      case 'aauNumber':\n        return (a.aauNumber || '').localeCompare(b.aauNumber || '');\n      default:\n        return 0;\n    }\n  });\n};","map":{"version":3,"names":["moment","getSafeDate","date","Date","toISOString","transformCoachData","coaches","guardians","currentUser","role","isCoach","createExtendedCoachRecord","coachRecords","map","coachGuardianRecords","flatMap","transformGuardianToRecord","coach","_id","fullName","email","phone","address","type","status","DateofJoin","createdAt","imgSrc","avatar","aauNumber","canView","players","guardian","baseGuardianRecord","mainGuardian","additionalGuardians","g","index","coachId","filterCoachData","data","filters","currentUserRole","filter","item","_item$email$toLowerCa","_item$email","_item$phone$replace$i","_item$phone","_item$aauNumber$toLow","_item$aauNumber","nameFilter","toLowerCase","includes","emailFilter","phoneFilter","replace","statusFilter","aauNumberFilter","dateRange","start","end","itemDate","isBetween","undefined","sortCoachData","sortOrder","sort","a","b","localeCompare","getTime","recentlyViewed","JSON","parse","localStorage","getItem","indexOf"],"sources":["/Users/davorins/Desktop/bs/src/utils/coachUtils.ts"],"sourcesContent":["import moment, { Moment } from 'moment';\nimport { Player, Coach, Guardian, TableRecord, Address } from '../types/types';\n\nexport interface ExtendedCoachRecord extends TableRecord {\n  _id: string;\n  fullName: string;\n  email: string;\n  phone: string;\n  address: string | Address;\n  type: 'coach' | 'guardian';\n  status: string;\n  DateofJoin: string;\n  imgSrc: string;\n  canView: boolean;\n  coachId?: string;\n  aauNumber: string;\n  createdAt: string;\n  players?: Player[];\n  isCoach: boolean;\n  role: string;\n  avatar?: string;\n}\n\ninterface CoachFilters {\n  nameFilter: string;\n  emailFilter: string;\n  phoneFilter: string;\n  statusFilter: string | null;\n  aauNumberFilter: string;\n  dateRange: [Moment, Moment] | null;\n}\n\nexport type CoachSortOrder =\n  | 'asc'\n  | 'desc'\n  | 'recentlyViewed'\n  | 'recentlyAdded'\n  | 'aauNumber'\n  | null;\n\nconst getSafeDate = (date?: string): string => date || new Date().toISOString();\n\n// Enhanced Guardian type with optional createdAt and additionalGuardians\ninterface EnhancedGuardian extends Omit<Guardian, 'players'> {\n  createdAt?: string;\n  additionalGuardians?: Array<\n    Omit<Guardian, 'additionalGuardians'> & { createdAt?: string }\n  >;\n  players?: Player[];\n}\n\nexport const transformCoachData = (\n  coaches: Coach[],\n  guardians: EnhancedGuardian[] = [],\n  currentUser: Coach | null\n): ExtendedCoachRecord[] => {\n  if (!currentUser) return [];\n\n  // For non-admin users, only show their own data\n  if (currentUser.role === 'user' && !currentUser.isCoach) {\n    return currentUser.isCoach ? [createExtendedCoachRecord(currentUser)] : [];\n  }\n\n  const coachRecords = coaches.map(createExtendedCoachRecord);\n  const coachGuardianRecords = guardians.flatMap(transformGuardianToRecord);\n\n  return [...coachRecords, ...coachGuardianRecords];\n};\n\nconst createExtendedCoachRecord = (coach: Coach): ExtendedCoachRecord => ({\n  ...coach,\n  _id: coach._id,\n  fullName: coach.fullName,\n  email: coach.email,\n  phone: coach.phone,\n  address: coach.address,\n  role: coach.role || 'coach',\n  isCoach: true,\n  type: 'coach',\n  status: coach.status || 'Active',\n  DateofJoin: getSafeDate(coach.createdAt),\n  imgSrc: coach.avatar || 'assets/img/profiles/coach-avatar.jpg',\n  aauNumber: coach.aauNumber || 'N/A',\n  canView: true,\n  createdAt: getSafeDate(coach.createdAt),\n  players: coach.players || [],\n});\n\nconst transformGuardianToRecord = (\n  guardian: EnhancedGuardian\n): ExtendedCoachRecord[] => {\n  const baseGuardianRecord = {\n    _id: guardian._id || '',\n    fullName: guardian.fullName,\n    email: guardian.email,\n    phone: guardian.phone,\n    address: guardian.address,\n    role: 'guardian',\n    isCoach: guardian.isCoach || false,\n    type: 'guardian' as const,\n    status: 'Active',\n    DateofJoin: getSafeDate(guardian.createdAt),\n    imgSrc: 'assets/img/profiles/avatar-27.jpg',\n    aauNumber: guardian.aauNumber || 'N/A',\n    canView: true,\n    createdAt: getSafeDate(guardian.createdAt),\n    players: guardian.players || [],\n  };\n\n  const mainGuardian: ExtendedCoachRecord = {\n    ...baseGuardianRecord,\n  };\n\n  const additionalGuardians = (guardian.additionalGuardians || []).map(\n    (g, index) => ({\n      ...baseGuardianRecord,\n      ...g,\n      _id: g._id || `${guardian._id}-${index}`,\n      coachId: guardian._id,\n    })\n  );\n\n  return [mainGuardian, ...additionalGuardians];\n};\n\nexport const filterCoachData = (\n  data: ExtendedCoachRecord[],\n  filters: CoachFilters,\n  currentUserRole: string\n): ExtendedCoachRecord[] => {\n  return data.filter((item) => {\n    // Role-based filtering\n    if (currentUserRole === 'user' && !item.canView) return false;\n    if (item.type !== 'guardian' && !item.isCoach) return false;\n\n    // Text filters\n    if (\n      filters.nameFilter &&\n      !item.fullName.toLowerCase().includes(filters.nameFilter.toLowerCase())\n    ) {\n      return false;\n    }\n\n    if (\n      filters.emailFilter &&\n      !(\n        item.email?.toLowerCase().includes(filters.emailFilter.toLowerCase()) ??\n        true\n      )\n    ) {\n      return false;\n    }\n\n    if (\n      filters.phoneFilter &&\n      !(\n        item.phone\n          ?.replace(/\\D/g, '')\n          .includes(filters.phoneFilter.replace(/\\D/g, '')) ?? true\n      )\n    ) {\n      return false;\n    }\n\n    if (filters.statusFilter && item.status !== filters.statusFilter) {\n      return false;\n    }\n\n    if (\n      filters.aauNumberFilter &&\n      !(\n        item.aauNumber\n          ?.toLowerCase()\n          .includes(filters.aauNumberFilter.toLowerCase()) ?? true\n      )\n    ) {\n      return false;\n    }\n\n    // Date range filter\n    if (filters.dateRange) {\n      const [start, end] = filters.dateRange;\n      const itemDate = moment(item.DateofJoin);\n      if (!itemDate.isBetween(start, end, undefined, '[]')) {\n        return false;\n      }\n    }\n\n    return true;\n  });\n};\n\nexport const sortCoachData = (\n  data: ExtendedCoachRecord[],\n  sortOrder: CoachSortOrder\n): ExtendedCoachRecord[] => {\n  if (!sortOrder) return [...data];\n\n  return [...data].sort((a, b) => {\n    switch (sortOrder) {\n      case 'asc':\n        return a.fullName.localeCompare(b.fullName);\n      case 'desc':\n        return b.fullName.localeCompare(a.fullName);\n      case 'recentlyAdded':\n        return (\n          new Date(b.DateofJoin).getTime() - new Date(a.DateofJoin).getTime()\n        );\n      case 'recentlyViewed':\n        const recentlyViewed = JSON.parse(\n          localStorage.getItem('recentlyViewed') || '[]'\n        );\n        return recentlyViewed.indexOf(b._id) - recentlyViewed.indexOf(a._id);\n      case 'aauNumber':\n        return (a.aauNumber || '').localeCompare(b.aauNumber || '');\n      default:\n        return 0;\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}