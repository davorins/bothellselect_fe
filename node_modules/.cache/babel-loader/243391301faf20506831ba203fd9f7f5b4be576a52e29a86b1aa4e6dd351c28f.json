{"ast":null,"code":"import * as r from \"react\";\nimport { useForm as g } from \"../../contexts/form/form.es.mjs\";\nfunction P({\n  callbacks: a,\n  id: p = \"rswps-cash-app-pay\",\n  redirectURL: c,\n  referenceId: u,\n  shape: m = \"round\",\n  size: l = \"medium\",\n  values: d = \"dark\",\n  width: f = \"static\",\n  ...q\n}) {\n  const [A, R] = r.useState(),\n    {\n      createPaymentRequest: n,\n      payments: i\n    } = g(),\n    w = r.useMemo(() => ({\n      redirectURL: c || window.location.href,\n      referenceId: u\n    }), [c, u]),\n    y = r.useMemo(() => {\n      const t = {\n        shape: m,\n        size: l,\n        values: d,\n        width: f\n      };\n      return Object.keys(t).reduce((o, e) => (t[e] !== void 0 && (o[e] = t[e]), o), {});\n    }, [m, l, d, f]);\n  if (r.useEffect(() => {\n    if (!n) throw new Error(\"`createPaymentRequest()` is required when using digital wallets\");\n    const t = new AbortController(),\n      {\n        signal: o\n      } = t;\n    let e;\n    return (async b => {\n      const h = i?.paymentRequest(n);\n      if (!h) throw new Error(\"`paymentRequest` is required when using digital wallets\");\n      try {\n        e = await i?.cashAppPay(h, w).then(s => {\n          if (!b?.aborted) return R(s), s;\n        }), await e?.attach(`#${p}`, y);\n      } catch (s) {\n        console.error(\"Initializing Cash App Pay failed\", s);\n      }\n    })(o), () => {\n      t.abort(), e?.destroy();\n    };\n  }, [n, y, w, i]), a) for (const t of Object.keys(a)) A?.addEventListener(t.toLowerCase(), a[t]);\n  return /* @__PURE__ */r.createElement(\"div\", {\n    ...q,\n    id: p\n  });\n}\nexport { P as default };","map":{"version":3,"names":["P","callbacks","a","id","p","redirectURL","c","referenceId","u","shape","m","size","l","values","d","width","f","q","A","R","r","useState","createPaymentRequest","n","payments","i","g","w","useMemo","window","location","href","y","t","Object","keys","reduce","o","e","useEffect","Error","AbortController","signal","b","h","paymentRequest","cashAppPay","then","s","aborted","attach","console","error","abort","destroy","addEventListener","toLowerCase","createElement"],"sources":["/Users/davorins/Desktop/bs/node_modules/react-square-web-payments-sdk/src/components/cash-app-pay/cash-app-pay.tsx"],"sourcesContent":["// Dependencies\nimport * as React from 'react';\nimport type * as Square from '@square/web-sdk';\n\n// Internals\nimport { useForm } from '~/contexts/form';\nimport type { CashAppPayProps } from './cash-app-pay.types';\n\nfunction CashAppPay({\n  callbacks,\n  id = 'rswps-cash-app-pay',\n  redirectURL,\n  referenceId,\n  shape = 'round',\n  size = 'medium',\n  values = 'dark',\n  width = 'static',\n  ...props\n}: CashAppPayProps) {\n  const [cashApp, setCashApp] = React.useState<Square.CashAppPay>();\n  const { createPaymentRequest, payments } = useForm();\n\n  const paymentRequestOptions: Square.CashAppPaymentRequestOptions = React.useMemo(\n    () => ({\n      redirectURL: redirectURL || window.location.href,\n      referenceId,\n    }),\n    [redirectURL, referenceId]\n  );\n\n  const options: Square.CashAppPayButtonOptions = React.useMemo(() => {\n    const baseOptions = {\n      shape,\n      size,\n      values,\n      width,\n    };\n\n    // if a value from options is undefined delete it from the options object\n    return Object.keys(baseOptions).reduce((acc: Record<string, unknown>, key) => {\n      if (baseOptions[key as keyof typeof baseOptions] !== undefined) {\n        acc[key as string] = baseOptions[key as keyof typeof baseOptions];\n      }\n\n      return acc;\n    }, {});\n  }, [shape, size, values, width]);\n\n  React.useEffect(() => {\n    if (!createPaymentRequest) {\n      throw new Error('`createPaymentRequest()` is required when using digital wallets');\n    }\n\n    const abortController = new AbortController();\n    const { signal } = abortController;\n    let cashApp: Square.CashAppPay | undefined;\n\n    const start = async (signal: AbortSignal) => {\n      const paymentRequest = payments?.paymentRequest(createPaymentRequest);\n\n      if (!paymentRequest) {\n        throw new Error('`paymentRequest` is required when using digital wallets');\n      }\n\n      try {\n        cashApp = await payments?.cashAppPay(paymentRequest, paymentRequestOptions).then((res) => {\n          if (signal?.aborted) {\n            return;\n          }\n\n          setCashApp(res);\n\n          return res;\n        });\n\n        await cashApp?.attach(`#${id}`, options);\n      } catch (error) {\n        console.error('Initializing Cash App Pay failed', error);\n      }\n    };\n\n    start(signal);\n\n    return () => {\n      abortController.abort();\n      cashApp?.destroy();\n    };\n  }, [createPaymentRequest, options, paymentRequestOptions, payments]);\n\n  if (callbacks) {\n    for (const callback of Object.keys(callbacks)) {\n      cashApp?.addEventListener(\n        callback.toLowerCase() as 'ontokenization',\n        (callbacks as Record<string, (event: Square.SqEvent<Square.CashAppPayEventData>) => void>)[callback]\n      );\n    }\n  }\n\n  return <div {...props} id={id} />;\n}\n\nexport default CashAppPay;\nexport * from './cash-app-pay.types';\n"],"mappings":";;AAQA,SAASA,EAAW;EAClBC,SAAA,EAAAC,CAAA;EACAC,EAAA,EAAAC,CAAA,GAAK;EACLC,WAAA,EAAAC,CAAA;EACAC,WAAA,EAAAC,CAAA;EACAC,KAAA,EAAAC,CAAA,GAAQ;EACRC,IAAA,EAAAC,CAAA,GAAO;EACPC,MAAA,EAAAC,CAAA,GAAS;EACTC,KAAA,EAAAC,CAAA,GAAQ;EAAA,GACLC;AACL,GAAoB;EAClB,MAAM,CAACC,CAAA,EAASC,CAAU,IAAIC,CAAA,CAAMC,QAAA,CAA4B;IAC1D;MAAEC,oBAAA,EAAAC,CAAA;MAAsBC,QAAA,EAAAC;IAAS,IAAIC,CAAA,CAAQ;IAE7CC,CAAA,GAA6DP,CAAA,CAAMQ,OAAA,CACvE,OAAO;MACLvB,WAAA,EAAaC,CAAA,IAAeuB,MAAA,CAAOC,QAAA,CAASC,IAAA;MAC5CxB,WAAA,EAAAC;IAAA,IAEF,CAACF,CAAA,EAAaE,CAAW;IAGrBwB,CAAA,GAA0CZ,CAAA,CAAMQ,OAAA,CAAQ,MAAM;MAClE,MAAMK,CAAA,GAAc;QAClBxB,KAAA,EAAAC,CAAA;QACAC,IAAA,EAAAC,CAAA;QACAC,MAAA,EAAAC,CAAA;QACAC,KAAA,EAAAC;MAAA;MAIF,OAAOkB,MAAA,CAAOC,IAAA,CAAKF,CAAW,EAAEG,MAAA,CAAO,CAACC,CAAA,EAA8BC,CAAA,MAChEL,CAAA,CAAYK,CAAA,MAAqC,WACnDD,CAAA,CAAIC,CAAA,IAAiBL,CAAA,CAAYK,CAAA,IAG5BD,CAAA,GACN,CAAE;IAAA,GACJ,CAAC3B,CAAA,EAAOE,CAAA,EAAME,CAAA,EAAQE,CAAK,CAAC;EA2C/B,IAzCAI,CAAA,CAAMmB,SAAA,CAAU,MAAM;IACpB,IAAI,CAAChB,CAAA,EACG,UAAIiB,KAAA,CAAM,iEAAiE;IAG7E,MAAAP,CAAA,GAAkB,IAAIQ,eAAA;MACtB;QAAEC,MAAA,EAAAL;MAAW,IAAAJ,CAAA;IACf,IAAAK,CAAA;IA0BJ,QAxBc,MAAOK,CAAA,IAAwB;MACrC,MAAAC,CAAA,GAAiBnB,CAAA,EAAUoB,cAAA,CAAetB,CAAoB;MAEpE,IAAI,CAACqB,CAAA,EACG,UAAIJ,KAAA,CAAM,yDAAyD;MAGvE;QACFF,CAAA,GAAU,MAAMb,CAAA,EAAUqB,UAAA,CAAWF,CAAA,EAAgBjB,CAAqB,EAAEoB,IAAA,CAAMC,CAAA,IAAQ;UACxF,IAAI,CAAAL,CAAA,EAAQM,OAAA,EAIZ,OAAA9B,CAAA,CAAW6B,CAAG,GAEPA,CAAA;QAAA,CACR,GAED,MAAMV,CAAA,EAASY,MAAA,CAAO,IAAI9C,CAAA,IAAM4B,CAAO;MAAA,SAChCgB,CAAA;QACCG,OAAA,CAAAC,KAAA,CAAM,oCAAoCJ,CAAK;MACzD;IAAA,GAGIX,CAAM,GAEL,MAAM;MACXJ,CAAA,CAAgBoB,KAAA,CAAM,GACtBf,CAAA,EAASgB,OAAA,CAAQ;IAAA;EAAA,GAElB,CAAC/B,CAAA,EAAsBS,CAAA,EAASL,CAAA,EAAuBF,CAAQ,CAAC,GAE/DvB,CAAA,EACF,WAAW+B,CAAA,IAAYC,MAAA,CAAOC,IAAA,CAAKjC,CAAS,GACjCgB,CAAA,EAAAqC,gBAAA,CACPtB,CAAA,CAASuB,WAAA,CAAY,GACpBtD,CAAA,CAA0F+B,CAAA;EAKjG,OAAQ,eAAAb,CAAA,CAAAqC,aAAA;IAAK,GAAGxC,CAAA;IAAOd,EAAA,EAAAC;EAAA,CAAQ;AACjC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}